/** jQuery Schedule v1.1.0 | https://github.com/Yehzuna/jquery-schedule */
!function(t,i,e,s){"use strict";function o(i,e){this.element=i,this.settings=t.extend({},r,e),this._defaults=r,this._name=n,this.init()}var n="jqs",r={debug:!1,mode:"edit",confirm:!0,hour:24,data:[],days:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],invalidPeriod:"Invalid period.",invalidPosition:"Invalid position.",removePeriod:"Remove this period ?"};t.extend(o.prototype,{init:function(){var i=this;t(this.element).addClass("jqs"),"edit"===this.settings.mode&&(t(this.element).on("click",".jqs-wrapper",function(e){if(t(e.target).hasClass("jqs-period")||t(e.target).parents(".jqs-period").length>0)return!1;var s=Math.round(e.offsetY/20);s>=48&&(s=47),i.add(t(this),"id_"+e.timeStamp,s)}),i.settings.confirm?t(this.element).on("click",".jqs-remove",function(){confirm(i.settings.removePeriod)&&t(this).parents(".jqs-period").remove()}):t(this.element).on("click",".jqs-remove",function(){t(this).parents(".jqs-period").remove()})),this.create(),this.generate()},create:function(){t('<table class="jqs-table"><tr></tr></table>').appendTo(t(this.element));for(var i=0;i<7;i++)t('<td><div class="jqs-wrapper"></div></td>').appendTo(t(".jqs-table tr",this.element));t('<div class="jqs-grid"><div class="jqs-grid-head"></div></div>').appendTo(t(this.element));for(var e=0;e<25;e++)t('<div class="jqs-grid-line"><span>'+this.formatHour(e)+"</span></div>").appendTo(t(".jqs-grid",this.element));for(var s=0;s<7;s++)t('<div class="jqs-grid-day">'+this.settings.days[s]+"</div>").appendTo(t(".jqs-grid-head",this.element))},generate:function(){if(this.settings.data.length>0){var i=this;t.each(this.settings.data,function(e,s){t.each(s.periods,function(e,o){var n=t(".jqs-wrapper",i.element).eq(s.day),r=i.positionFormat(o[0]),a=i.positionFormat(o[1]);if(0===a&&(a=48),r<=a){var d="id_"+e+s.day+r+a;i.add(n,d,r,a-r)}else i.settings.debug&&console.error(i.settings.invalidPeriod,i.periodInit(r,r+(a-r)))})})}},add:function(i,e,s,o){o||(o=1);var n="";"edit"===this.settings.mode&&(n='<div class="jqs-remove"></div>');var r=this.periodInit(s,s+o),a=t('<div class="jqs-period"><div class="jqs-period-placeholder">'+n+"<span>"+r+"</span></div></div>").css({top:20*s,height:20*o}).attr("id",e).appendTo(i);if(!this.isValid(a))return this.settings.debug&&console.error(this.settings.invalidPeriod,r),t(a).remove(),!1;if("edit"===this.settings.mode){var d=this;a.draggable({grid:[0,20],containment:"parent",drag:function(i,e){t("span",e.helper).text(d.periodDrag(e))},stop:function(i,e){d.isValid(t(e.helper))||(d.settings.debug&&console.error(d.settings.invalidPosition),t(e.helper).css("top",Math.round(e.originalPosition.top)))}}).resizable({grid:[0,20],containment:"parent",handles:"n, s",resize:function(i,e){t("span",e.helper).text(d.periodResize(e))},stop:function(i,e){d.isValid(t(e.helper))||(d.settings.debug&&console.error(d.settings.invalidPosition),t(e.helper).css({height:Math.round(e.originalSize.height),top:Math.round(e.originalPosition.top)}))}})}},periodInit:function(t,i){return this.periodFormat(t)+" - "+this.periodFormat(i)},periodDrag:function(i){var e=Math.round(i.position.top/20),s=Math.round((t(i.helper).height()+i.position.top)/20);return this.periodFormat(e)+" - "+this.periodFormat(s)},periodResize:function(t){var i=Math.round(t.position.top/20),e=Math.round((t.size.height+t.position.top)/20);return this.periodFormat(i)+" - "+this.periodFormat(e)},periodData:function(t){var i=Math.round(t.position().top/20),e=Math.round((t.height()+t.position().top)/20);return[this.periodFormat(i),this.periodFormat(e)]},periodFormat:function(t){var i=0;if(12===this.settings.hour){var e=Math.floor(t/2),s=":30";t%2==0&&(s=""),i=e+s+"am",e>12&&(i=e-12+s+"pm"),0!==e&&24!==e||(i=12+s+"am"),12===e&&(i=12+s+"pm")}else t>=48&&(t=0),(i=Math.floor(t/2))<10&&(i="0"+i),i+=t%2==0?":00":":30";return i},positionFormat:function(t){var i=0;if(12===this.settings.hour){var e=t.match(/([0-1]?[0-9]):?([0-5][0-9])?\s?(am|pm)/),s=parseInt(e[1]),o=parseInt(e[2]),n=e[3];12===s&&"am"===n&&(s=0),12===s&&"pm"===n&&(n="am"),"pm"===n&&(s+=12),i=2*s,30===o&&i++}else{var r=t.split(":");i=2*parseInt(r[0]),30===parseInt(r[1])&&i++}return i},formatHour:function(t){if(12===this.settings.hour)switch(t){case 0:case 24:t="12 am";break;case 12:t="12 pm";break;default:t>12?t=t-12+" pm":t+=" am"}else t>=24&&(t=0),t<10&&(t="0"+t),t+=":00";return t},isValid:function(i){var e=Math.round(i.position().top),s=Math.round(i.position().top+i.height()),o=0,n=0,r=!0;return t(".jqs-period",t(i).parent()).each(function(a,d){d=t(d),i.attr("id")!==d.attr("id")&&(o=Math.round(d.position().top),n=Math.round(d.position().top+d.height()),o>e&&o<s&&(r=!1),n>e&&n<s&&(r=!1),o<e&&n>s&&(r=!1),o!==e&&n!==s||(r=!1))}),r},export:function(){var i=this,e=[];return t(".jqs-wrapper",i.element).each(function(s,o){var n={day:s,periods:[]};t(".jqs-period",o).each(function(e,s){n.periods.push(i.periodData(t(s)))}),e.push(n)}),JSON.stringify(e)}}),t.fn[n]=function(i){var e=!1,s=this.each(function(){t.data(this,"plugin_"+n)?t.isFunction(o.prototype[i])&&(e=t.data(this,"plugin_"+n)[i]()):t.data(this,"plugin_"+n,new o(this,i))});return e||s}}(jQuery,window,document);