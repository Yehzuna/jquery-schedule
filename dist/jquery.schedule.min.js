/** jQuery Schedule v1.1.0 | https://github.com/Yehzuna/jquery-schedule */
!function(i,t,e,s){"use strict";function o(t,e){this.element=t,this.settings=i.extend({},a,e),this._defaults=a,this._name=n,this.init()}var n="jqs",a={debug:!1,mode:"edit",confirm:!0,hour:24,data:[],days:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],invalidPeriod:"Invalid period.",invalidPosition:"Invalid position.",removePeriod:"Remove this period ?",dialogYes:"Yes",dialogNo:"No"};i.extend(o.prototype,{init:function(){var t=this;i(this.element).addClass("jqs"),"edit"===this.settings.mode&&(i(this.element).on("click",".jqs-wrapper",function(e){if(i(e.target).hasClass("jqs-period")||i(e.target).parents(".jqs-period").length>0)return!1;var s=Math.round(e.offsetY/20);s>=48&&(s=47),t.add(i(this),"id_"+e.timeStamp,s)}),t.settings.confirm?i(this.element).on("click",".jqs-remove",function(){var e=i(this).parents(".jqs-period");t.dialogOpen(t.settings.removePeriod,function(){e.remove()})}):i(this.element).on("click",".jqs-remove",function(){i(this).parents(".jqs-period").remove()})),this.create(),this.generate()},create:function(){i('<table class="jqs-table"><tr></tr></table>').appendTo(i(this.element));for(var t=0;t<7;t++)i('<td><div class="jqs-wrapper"></div></td>').appendTo(i(".jqs-table tr",this.element));i('<div class="jqs-grid"><div class="jqs-grid-head"></div></div>').appendTo(i(this.element));for(var e=0;e<25;e++)i('<div class="jqs-grid-line"><span>'+this.formatHour(e)+"</span></div>").appendTo(i(".jqs-grid",this.element));for(var s=0;s<7;s++)i('<div class="jqs-grid-day">'+this.settings.days[s]+"</div>").appendTo(i(".jqs-grid-head",this.element))},generate:function(){if(this.settings.data.length>0){var t=this;i.each(this.settings.data,function(e,s){i.each(s.periods,function(e,o){var n=i(".jqs-wrapper",t.element).eq(s.day),a=t.positionFormat(o[0]),r=t.positionFormat(o[1]);if(0===r&&(r=48),a<=r){var d="id_"+e+s.day+a+r;t.add(n,d,a,r-a)}else t.settings.debug&&console.error(t.settings.invalidPeriod,t.periodInit(a,a+(r-a)))})})}},add:function(t,e,s,o){o||(o=1);var n="";"edit"===this.settings.mode&&(n='<div class="jqs-remove"></div>');var a=this.periodInit(s,s+o),r=i('<div class="jqs-period"><div class="jqs-period-placeholder">'+n+"<span>"+a+"</span></div></div>").css({top:20*s,height:20*o}).attr("id",e).appendTo(t);if(!this.isValid(r))return this.settings.debug&&console.error(this.settings.invalidPeriod,a),i(r).remove(),!1;if("edit"===this.settings.mode){var d=this;r.draggable({grid:[0,20],containment:"parent",drag:function(t,e){i("span",e.helper).text(d.periodDrag(e))},stop:function(t,e){d.isValid(i(e.helper))||(d.settings.debug&&console.error(d.settings.invalidPosition),i(e.helper).css("top",Math.round(e.originalPosition.top)))}}).resizable({grid:[0,20],containment:"parent",handles:"n, s",resize:function(t,e){i("span",e.helper).text(d.periodResize(e))},stop:function(t,e){d.isValid(i(e.helper))||(d.settings.debug&&console.error(d.settings.invalidPosition),i(e.helper).css({height:Math.round(e.originalSize.height),top:Math.round(e.originalPosition.top)}))}})}},periodInit:function(i,t){return this.periodFormat(i)+" - "+this.periodFormat(t)},periodDrag:function(t){var e=Math.round(t.position.top/20),s=Math.round((i(t.helper).height()+t.position.top)/20);return this.periodFormat(e)+" - "+this.periodFormat(s)},periodResize:function(i){var t=Math.round(i.position.top/20),e=Math.round((i.size.height+i.position.top)/20);return this.periodFormat(t)+" - "+this.periodFormat(e)},periodData:function(i){var t=Math.round(i.position().top/20),e=Math.round((i.height()+i.position().top)/20);return[this.periodFormat(t),this.periodFormat(e)]},periodFormat:function(i){var t=0;if(12===this.settings.hour){var e=Math.floor(i/2),s=":30";i%2==0&&(s=""),t=e+s+"am",e>12&&(t=e-12+s+"pm"),0!==e&&24!==e||(t=12+s+"am"),12===e&&(t=12+s+"pm")}else i>=48&&(i=0),(t=Math.floor(i/2))<10&&(t="0"+t),t+=i%2==0?":00":":30";return t},positionFormat:function(i){var t=0;if(12===this.settings.hour){var e=i.match(/([0-1]?[0-9]):?([0-5][0-9])?\s?(am|pm)/),s=parseInt(e[1]),o=parseInt(e[2]),n=e[3];12===s&&"am"===n&&(s=0),12===s&&"pm"===n&&(n="am"),"pm"===n&&(s+=12),t=2*s,30===o&&t++}else{var a=i.split(":");t=2*parseInt(a[0]),30===parseInt(a[1])&&t++}return t},formatHour:function(i){if(12===this.settings.hour)switch(i){case 0:case 24:i="12 am";break;case 12:i="12 pm";break;default:i>12?i=i-12+" pm":i+=" am"}else i>=24&&(i=0),i<10&&(i="0"+i),i+=":00";return i},isValid:function(t){var e=Math.round(t.position().top),s=Math.round(t.position().top+t.height()),o=0,n=0,a=!0;return i(".jqs-period",i(t).parent()).each(function(r,d){d=i(d),t.attr("id")!==d.attr("id")&&(o=Math.round(d.position().top),n=Math.round(d.position().top+d.height()),o>e&&o<s&&(a=!1),n>e&&n<s&&(a=!1),o<e&&n>s&&(a=!1),o!==e&&n!==s||(a=!1))}),a},export:function(){var t=this,e=[];return i(".jqs-wrapper",t.element).each(function(s,o){var n={day:s,periods:[]};i(".jqs-period",o).each(function(e,s){n.periods.push(t.periodData(i(s)))}),e.push(n)}),JSON.stringify(e)},dialogOpen:function(t,e){var s=this;s.dialogClose();var o=i('<div class="jqs-dialog-overlay">'),n=i(this.element).prop("scrollHeight");o.css("height",n);var a='<div class="jqs-dialog-txt">'+t+'</div><div class="jqs-dialog-no">'+s.settings.dialogNo+'</div><div class="jqs-dialog-yes">'+s.settings.dialogYes+"</div>",r=i('<div class="jqs-dialog-container"><div class="jqs-dialog">'+a+"</div></div>"),d=i(this.element).scrollTop();r.css("top",d),i(this.element).append(o).append(r),i(".jqs-dialog-yes",r).click(function(){e(),s.dialogClose()}),i(".jqs-dialog-no",r).click(function(){s.dialogClose()})},dialogClose:function(){i(".jqs-dialog-overlay, .jqs-dialog-container").remove()}}),i.fn[n]=function(t){var e=!1,s=this.each(function(){i.data(this,"plugin_"+n)?i.isFunction(o.prototype[t])&&(e=i.data(this,"plugin_"+n)[t]()):i.data(this,"plugin_"+n,new o(this,t))});return e||s}}(jQuery,window,document);